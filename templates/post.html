<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" th:replace="modules/layout :: html(content = ~{::content})">
<th:block th:fragment="content">
  <div class="grid grid-cols-10 gap-4">
    <div class="col-span-10 md:col-span-7">
      <div class="md:hidden rounded-lg">
        <img class="w-full rounded-lg" th:if="${not #strings.isEmpty(post.spec.cover)}"
          th:src="${post.spec.cover}"></img>
      </div>
      <div class="bg-white rounded-lg ">
        <div th:if="${post.spec.cover.isEmpty}" class="w-full h-96 bg-cover bg-center rounded-t-lg flex"
          th:style="'background-image:url(' + ${post.spec.cover.isEmpty} + ')'">
          <div
            class="rounded-t-lg w-full h-full backdrop-blur-lg backdrop-brightness-110 backdrop-saturate-50 relative">
            <div class="space-y-2 p-4 md:p-8 absolute bottom-0 text-white">
              <div class="font-bold text-4xl hover:text-blue-700 transition duration-700" th:text="${post.spec.title}">
              </div>
              <div class="flex space-x-6">
                <div class="flex space-x-2">
                  <div th:if="${post.owner.avatar}" class="w-4 h-4 rounded-lg bg-center bg-cover"
                    th:style="'background-image:url(' + ${post.owner.avatar} + ')'">
                  </div>
                  <div th:unless="${post.owner.avatar}" class="i-tabler-user"></div>
                  <div class="text-xs" th:text="${post.owner.displayName}"></div>
                </div>
                <div class="flex space-x-2">
                  <div class="i-tabler-calendar"></div>
                  <div class="text-xs" th:text="${#dates.format(post.status.lastModifyTime,'yyyy-MM-dd HH:mm')}"></div>
                </div>
              </div>
              <div class="flex space-x-6">
                <div class="flex space-x-2">
                  <div class="i-tabler-eye"></div>
                  <div class="text-xs">累计阅读<span class="mx-0.5" th:text="${post.stats.visit}"></span>次</div>
                </div>

                <div class="flex space-x-2">
                  <div class="i-tabler-message"></div>
                  <div class="text-xs">评论<span class="mx-0.5" th:text="${post.stats.comment}"></span>条</div>
                </div>
              </div>
              <div class="space-x-1 flex">
                <a th:each="categorie : ${post.categories}" th:href="${categorie.status.permalink}"
                  class="bg-black/10 backdrop-blur-lg backdrop-brightness-150 text-green-100 px-1.5 p-0.1 flex items-center space-x-0.5 w-fit rounded-lg">
                  <div class="i-tabler-box"></div>
                  <div class="text-xs" th:text="${categorie.spec.displayName}"></div>
                </a>
                <a th:each="tag : ${post.tags}" th:href="${tag.status.permalink}"
                  class="bg-black/10 backdrop-blur-lg backdrop-brightness-150 text-blue-100 px-1.5 p-0.5 flex items-center space-x-0.5 w-fit rounded-lg">
                  <div class="i-tabler-tag"></div>
                  <div class="text-xs" th:text="${tag.spec.displayName}"></div>
                </a>
              </div>
            </div>
          </div>
        </div>
        <div th:unless="${post.spec.cover.isEmpty}" class="w-full h-96 bg-cover bg-center rounded-t-lg "
          th:style="'background-image:url(' + ${theme.config.global.default_cover} + ')'">
          <div
            class="rounded-t-lg w-full h-full backdrop-blur-lg backdrop-brightness-110 backdrop-saturate-50 relative">
            <div class="space-y-2  p-4 md:p-8 absolute bottom-0 text-white">
              <div class="font-bold text-4xl hover:text-blue-700 transition duration-700" th:text="${post.spec.title}">
              </div>
              <div class="flex space-x-6">
                <div class="flex space-x-2">
                  <div th:if="${post.owner.avatar}" class="w-4 h-4 rounded-lg bg-center bg-cover"
                    th:style="'background-image:url(' + ${post.owner.avatar} + ')'">
                  </div>
                  <div th:unless="${post.owner.avatar}" class="i-tabler-user"></div>
                  <div class="text-xs" th:text="${post.owner.displayName}"></div>
                </div>
                <div class="flex space-x-2">
                  <div class="i-tabler-calendar"></div>
                  <div class="text-xs" th:text="${#dates.format(post.status.lastModifyTime,'yyyy-MM-dd HH:mm')}"></div>
                </div>
              </div>
              <div class="flex space-x-6">
                <div class="flex space-x-2">
                  <div class="i-tabler-eye"></div>
                  <div class="text-xs">累计阅读<span class="mx-0.5" th:text="${post.stats.visit}"></span>次</div>
                </div>

                <div class="flex space-x-2">
                  <div class="i-tabler-message"></div>
                  <div class="text-xs">评论<span class="mx-0.5" th:text="${post.stats.comment}"></span>条</div>
                </div>
              </div>
              <div class="space-x-1 flex">
                <a th:unless="${post.categories.size() == 0}" th:each="categorie : ${post.categories}"
                  th:href="${categorie.status.permalink}"
                  class="bg-black/10 backdrop-blur-lg backdrop-brightness-150 text-green-100 px-1.5 p-0.1 flex items-center space-x-0.5 w-fit rounded-lg">
                  <div class="i-tabler-box"></div>
                  <div class="text-xs" th:text="${categorie.spec.displayName}"></div>
                </a>
                <a th:unless="${post.tags.size() == 0}" th:each="tag : ${post.tags}" th:href="${tag.status.permalink}"
                  class="bg-black/10 backdrop-blur-lg backdrop-brightness-150 text-blue-100 px-1.5 p-0.5 flex items-center space-x-0.5 w-fit rounded-lg">
                  <div class="i-tabler-tag"></div>
                  <div class="text-xs" th:text="${tag.spec.displayName}"></div>
                </a>
              </div>
            </div>
          </div>
        </div>
        <article th:unless="${#annotations.get(post, 'login_before_read') and #authentication.name == 'anonymousUser'}"
          class="prose !max-w-none p-4 md:p-8"
          th:classappend="${theme.config.post.content_size} + ' ' + ${theme.config.post.content_theme}">
          <th:block th:utext="${post.content.content}"></th:block>
        </article>
        <article th:if="${#annotations.get(post, 'login_before_read') and #authentication.name == 'anonymousUser' }"
          class="prose !max-w-none p-4 md:p-8"
          th:classappend="${theme.config.post.content_size} + ' ' + ${theme.config.post.content_theme}">
          <th:block th:utext="${#annotations.get(post, 'login_before_read_summary')}"></th:block>
        </article>
        <div th:if="${#annotations.get(post, 'login_before_read') and #authentication.name == 'anonymousUser' }"
          class="border-t m-4 my-0"></div>
        <div th:if="${#annotations.get(post, 'login_before_read') and #authentication.name == 'anonymousUser' }"
          class="flex justify-center items-center my-4">
          <div class="font-bold to-gray-600 text-sm">作者设定登录后可见</div>
        </div>
        <div th:if="${#annotations.get(post, 'login_before_read') and #authentication.name == 'anonymousUser' }"
          class="flex justify-center items-center my-4">
          <a th:href="'/console/login?redirect_uri='+ ${post.status.permalink}"
            class="w-fit bg-blue-50 hover:bg-blue-500 text-blue-700 hover:text-white transition duration-700 hover:shadow-2xl p-3 py-2  flex items-center justify-center space-x-0 rounded-lg">
            <div class="text-sm">立刻登录</div>
            <div class="i-tabler-arrow-right"></div>
          </a>
        </div>
        <div class="border-t m-4 my-0"></div>
        <div class="bg-white rounded-lg space-y-2">
          <div class="p-8">
            <div class="space-y-4 " th:if="${pluginFinder.available('PluginCommentWidget')}">
              <div class="text-xl font-bold">评论</div>
              <halo:comment group="content.halo.run" kind="Post" th:attr="name=${post.metadata.name}"
                colorScheme="'light'" />
            </div>
          </div>
        </div>
      </div>

    </div>
    <div class="col-span-10 md:col-span-3 space-y-2">
      <div class="rounded-lg ">
        <img class="w-full rounded-lg" th:if="${post.spec.cover.isEmpty}" th:src="${singlePage.spec.cover}"></img>
        <img class="w-full rounded-lg" th:unless="${post.spec.cover.isEmpty}"
          th:src="${theme.config.global.default_cover}"></img>
      </div>
      <div th:if="${#annotations.get(post, 'app')}" class="w-full p-4 rounded-lg bg-white space-y-2">
        <div class="text-md text-gray-700 font-bold">APP资源</div>
        <div class="border-t"></div>
        <div class="flex justify-start items-start space-x-4">
          <div class="h-12 w-12 bg-center bg-cover rounded-lg"
            th:style="'background-image:url(' + ${#annotations.get(post, 'app_icon')} + ')'"></div>
          <div>
            <div class="text-md text-gray-700 font-bold" th:text="${#annotations.get(post, 'app_name')}"></div>
            <div class="text-xs text-gray-500 font-bold" th:text="${#annotations.get(post, 'app_version')}"></div>
          </div>
        </div>
      </div>
      <div th:if="${#annotations.get(post, 'book')}" class="w-full p-4 rounded-lg bg-white space-y-2">
        <div class="text-md text-gray-700 font-bold">图书资源</div>
        <div class="border-t"></div>
        <div class="flex justify-start items-start space-x-4">
          <div class="h-16 w-12 bg-center bg-cover rounded-lg"
            th:style="'background-image:url(' + ${#annotations.get(post, 'book_cover')} + ')'"></div>
          <div>
            <div class="text-md text-gray-700 font-bold" th:text="${#annotations.get(post, 'book_name')}"></div>
            <div class="text-xs text-gray-500 font-bold" th:text="${#annotations.get(post, 'book_author')}"></div>
          </div>
        </div>
      </div>
      <div th:if="${#annotations.get(post, 'resource')}" class="w-full p-4 rounded-lg bg-white space-y-2">
        <div class="text-md text-gray-700 font-bold" th:text="${#annotations.get(post, 'resource_name')}"></div>
        <div class="border-t"></div>
        <a th:href="${#annotations.get(post, 'resource_download')}"
          class="w-full p-2 rounded-lg bg-blue-50 text-blue-700 hover:bg-blue-200  hover:border hover:border-blue-700 transition transition-all duration-700 space-x-2 flex items-center justify-center">
          <div class="i-tabler-download"></div>
          <div class="text-sm font-bold " th:text="${#annotations.get(post, 'resource_method')}"></div>
        </a>
      </div>
    </div>

  </div>
</th:block>

</html>